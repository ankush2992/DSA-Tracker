<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>DSA Tracker</title>
  <script>
    (function() {
      const THEME_KEY = 'dsa-theme';
      const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      const storedTheme = localStorage.getItem(THEME_KEY);
      const initialTheme = storedTheme || (prefersDark ? 'dark' : 'light');
      document.documentElement.setAttribute('data-bs-theme', initialTheme);
      document.documentElement.dataset.theme = initialTheme;
    })();
  </script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <style>
    html[data-bs-theme='light'] {
      --brand-primary: #2563eb;
      --brand-surface: #f5f7fb;
      --brand-card: #ffffff;
      --brand-border: #e2e8f0;
      --brand-table-alt: rgba(37, 99, 235, 0.05);
    }
    html[data-bs-theme='dark'] {
      --brand-primary: #60a5fa;
      --brand-surface: #0f172a;
      --brand-card: #111c36;
      --brand-border: #1e293b;
      --brand-table-alt: rgba(96, 165, 250, 0.12);
    }
    body {
      padding-bottom: 60px;
      background-color: var(--brand-surface);
      transition: background-color 0.3s ease, color 0.3s ease;
    }
    html[data-bs-theme='dark'] body {
      color: #e2e8f0;
    }
    html[data-bs-theme='light'] body {
      color: #1f2937;
    }
    .navbar-brand {
      font-weight: 700;
    }
    .card {
      border-radius: 1rem;
      background-color: var(--brand-card);
      border-color: var(--brand-border);
      box-shadow: 0 12px 30px -12px rgba(15, 23, 42, 0.35);
      transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
    }
    .table-light {
      background-color: rgba(148, 163, 184, 0.18) !important;
    }
    .table-hover tbody tr:hover {
      background-color: rgba(37, 99, 235, 0.12);
    }
    html[data-bs-theme='dark'] .table-hover tbody tr:hover {
      background-color: rgba(96, 165, 250, 0.24);
    }
    .table-striped tbody tr:nth-of-type(odd) {
      background-color: var(--brand-table-alt);
    }
    html[data-bs-theme='dark'] .badge.bg-success-subtle {
      background-color: rgba(74, 222, 128, 0.18) !important;
      color: #4ade80 !important;
    }
    html[data-bs-theme='dark'] .badge.bg-danger {
      background-color: rgba(248, 113, 113, 0.2) !important;
    }
    html[data-bs-theme='dark'] .badge.bg-secondary-subtle {
      background-color: rgba(148, 163, 184, 0.22) !important;
      color: #cbd5f5 !important;
    }
    .btn-gradient {
      background: linear-gradient(135deg, var(--brand-primary), #7c3aed);
      border: none;
      color: #fff;
    }
    .btn-gradient:hover {
      filter: brightness(1.05);
      color: #fff;
    }
    nav.navbar {
      background: linear-gradient(135deg, var(--brand-primary), #1d4ed8) !important;
    }
    html[data-bs-theme='dark'] nav.navbar {
      background: linear-gradient(135deg, #0f172a, #1e293b) !important;
    }
    html[data-bs-theme='dark'] .nav-link {
      color: rgba(226, 232, 240, 0.85) !important;
    }
    html[data-bs-theme='dark'] .nav-link:hover {
      color: #fff !important;
    }
  </style>
</head>
<body>
<nav class="navbar navbar-dark bg-primary navbar-expand-lg mb-4">
  <div class="container">
    <a class="navbar-brand" href="{{ url_for('index') }}">DSA Tracker</a>
    <ul class="navbar-nav ms-auto">
      <li class="nav-item"><a class="nav-link" href="{{ url_for('topics_list') }}">Topics</a></li>
      <li class="nav-item"><a class="nav-link" href="{{ url_for('problems_list') }}">Problems</a></li>
      <li class="nav-item"><a class="nav-link" href="{{ url_for('sessions_list') }}">Sessions</a></li>
      <li class="nav-item"><a class="nav-link" href="{{ url_for('import_view') }}">Import</a></li>
      <li class="nav-item"><a class="nav-link" href="{{ url_for('export_csv') }}">Export</a></li>
      <li class="nav-item ms-3">
        <button class="btn btn-sm btn-outline-light" id="theme-toggle" type="button">Dark Mode</button>
      </li>
    </ul>
  </div>
</nav>

<div class="container">
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="mt-2">
        {% for category, message in messages %}
          <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
          </div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  {% block content %}{% endblock %}
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
