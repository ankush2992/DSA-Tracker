{% extends 'base.html' %}
{% block content %}
<div class="row g-3">
  <div class="col-lg-6">
    <div class="card p-3">
      <h5>Log Session</h5>
      <form method="post" action="{{ url_for('sessions_new') }}">
        <div class="row g-2">
          <div class="col-6"><input type="date" class="form-control" name="date"></div>
          <div class="col-6"><input class="form-control" name="duration_minutes" type="number" min="0" placeholder="Minutes"></div>
          <div class="col-6">
            <select class="form-select" name="topic_id">
              <option value="">— Topic —</option>
              {% for t in topics %}<option value="{{ t.id }}">{{ t.name }}</option>{% endfor %}
            </select>
          </div>
          <div class="col-6">
            <select class="form-select" name="problem_id">
              <option value="">— Problem (optional) —</option>
              {% for p in problems %}<option value="{{ p.id }}">{{ p.title[:40] }}</option>{% endfor %}
            </select>
          </div>
          <div class="col-6">
            <select class="form-select" name="outcome">
              <option>Solved</option><option>Hint</option><option>Editorial</option><option>Unsolved</option>
            </select>
          </div>
          <div class="col-12"><textarea class="form-control" rows="2" name="notes" placeholder="Approach / notes"></textarea></div>
          <div class="col-12"><button class="btn btn-primary">Save</button></div>
        </div>
      </form>
    </div>
  </div>
  <div class="col-lg-6">
    <div class="card p-3">
      <h5>Bulk Log (multiple lines)</h5>
      <p class="small text-muted">Format: <code>YYYY-MM-DD | Topic | Title | Minutes | Outcome | Notes</code></p>
      <form method="post" action="{{ url_for('sessions_bulk') }}">
        <textarea class="form-control" rows="8" name="bulk" placeholder="2025-10-24 | Arrays | Two Sum | 25 | Solved | used hash map..."></textarea>
        <div class="mt-2"><button class="btn btn-secondary">Import Sessions</button></div>
      </form>
    </div>
  </div>
</div>

<div class="card p-3 mt-3">
  <h5>Recent Sessions</h5>
  <div class="table-responsive">
  <table class="table table-striped">
    <thead><tr><th>Date</th><th>Topic</th><th>Problem</th><th>Minutes</th><th>Outcome</th><th>Notes</th></tr></thead>
    <tbody>
      {% for s in sessions %}
        <tr>
          <td>{{ s.date or '—' }}</td>
          <td>{{ s.topic.name if s.topic else '—' }}</td>
          <td>{{ s.problem.title if s.problem else '—' }}</td>
          <td>{{ s.duration_minutes }}</td>
          <td>{{ s.outcome }}</td>
          <td>{{ s.approach_notes or '—' }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
  </div>
</div>
{% endblock %}
